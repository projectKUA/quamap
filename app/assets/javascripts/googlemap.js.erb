function getContentString(name, quality, effect, url){
	var ret =
		'<div id="content">'+
	  '<div id="siteNotice"></div>'+
	  '<h1 id="firstHeading" class="firstHeading" style="white-space: nowrap;">' + name + '</h1>'+
	  '<div id="bodyContent">'+
	  '<p style="white-space: nowrap;"><b>泉質:</b>' + quality + '</p>'+
	  '<p><b>効能:</b>' + effect + '</p>'+
	  '<p style="white-space: nowrap;"><b>HP:</b><a href="' + url + '" target="_brank">' + url + '</a></p>' +
	  '</div></div>';
	return ret;
}

var styles = [
	{
		"featureType": "administrative.country",
		"stylers": [
			{ "visibility": "off" }
		]
	},{
		"elementType": "labels",
		"stylers": [
			{ "visibility": "off" }
		]
	},{
		"featureType": "landscape",
		"stylers": [
			{ "color": "#ffffff" }
		]
	},{
		"featureType": "poi",
		"stylers": [
			{ "visibility": "off" }
		]
	},{
		"featureType": "road",
		"elementType": "geometry.fill",
		"stylers": [
			{ "visibility": "on" },
			{ "color": "#ffffff" }
		]
	},{
		"elementType": "geometry.stroke",
		"stylers": [
			{ "color": "#cfcfd0" }
		]
	}
];

// 温泉情報　名称,緯度,経度,泉質,効能
var stations = [
    <% @quas = Qua.all %>
    <% @quas.each do |q| %>
	[ '<%= q.name %>', <%= q.latitude %>, <%= q.longitude %>,'<%= q.quality.html_safe %>', '<%= q.effect.html_safe %>', '<%= q.url %>' ] <%= ", " unless q == @quas.last %>
	<% end %>
];


google.maps.event.addDomListener(window, 'load', function()
{

	var center = new google.maps.LatLng(38.743224, 140.715955);
	var mapOptions = {
		zoom: 14,
		center: center,
		mapTypeIds: [google.maps.MapTypeId.ROADMAP, 'map_style'],
		scaleControl: true
	};
	var mapObj = new google.maps.Map(document.getElementById('gmap'), mapOptions);

	// Create a new StyledMapType object, passing it the array of styles,
	// as well as the name to be displayed on the map type control.
	var styledMap = new google.maps.StyledMapType(styles,
		{name: "Styled Map"});
	//Associate the styled map with the MapTypeId and set it to display.
	mapObj.mapTypes.set('map_style', styledMap);
	mapObj.setMapTypeId('map_style');

	// マーカーを作成
	var icon = new google.maps.MarkerImage('http://docs.google.com/uc?export=view&id=0B15A7hRyx7EIVjJTNkZpYjJGQlk',
		// This marker is 20 pixels wide by 32 pixels tall.
		new google.maps.Size(24, 24),
		// The origin for this image is 0,0.
		new google.maps.Point(0,0),
		// The anchor for this image is the base of the flagpole at 0,32.
		new google.maps.Point(0, 24)
	);

	jQuery.each(stations, function()
	{
		var latlng = new google.maps.LatLng(this[1], this[2]);
		var marker = new google.maps.Marker({
			position: latlng,
			map: mapObj,
			title: this[0],
			icon: icon
		});
		var infowindow = new google.maps.InfoWindow({
			content: getContentString(this[0], this[3], this[4], this[5])
		});
		google.maps.event.addListener(marker, 'click', function() {
		  infowindow.open(mapObj,marker);
		});
	});

	var kmlLayer = new google.maps.KmlLayer({
		driveFileId: "0B2w7buxyq8qvU3hCZzFfWTFkajQ",
		preserveViewport: true
	});
	kmlLayer.setMap(mapObj);

});
